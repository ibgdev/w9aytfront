<app-navbar></app-navbar>
<div class="conversations-container">
  <h2>My Conversations</h2>
  
  <div *ngIf="isLoading" class="loading">Loading conversations...</div>
  
  <div *ngIf="!isLoading && conversations.length === 0" class="empty-state">
    <p>No conversations yet. Start a chat from your delivery history!</p>
  </div>
  
  <div *ngIf="!isLoading && conversations.length > 0" class="conversations-list">
    <div 
      *ngFor="let conv of conversations" 
      class="conversation-item"
      (click)="openConversation(conv.id)"
    >
      <div class="conversation-header">
        <h3>{{ conv.subject || 'Delivery #' + conv.delivery_id }}</h3>
        <span *ngIf="conv.unread_count > 0" class="unread-badge">{{ conv.unread_count }}</span>
      </div>
      <div class="conversation-info">
        <p class="other-user">With: {{ conv.other_user_name || 'Unknown' }}</p>
        <p class="last-message" *ngIf="conv.last_message_text">
          {{ conv.last_message_text.length > 50 ? (conv.last_message_text.substring(0, 50) + '...') : conv.last_message_text }}
        </p>
        <p class="last-message-time" *ngIf="conv.last_message_time">
          {{ formatDate(conv.last_message_time) }}
        </p>
      </div>
    </div>
  </div>
</div>
<app-footer></app-footer>

